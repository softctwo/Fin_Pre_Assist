# 金融售前方案辅助编写系统 - 架构设计

## 系统概述

本系统旨在帮助金融行业售前工程师快速生成高质量的售前方案，通过AI技术分析历史方案和客户需求，自动生成定制化的新方案。

## 核心功能模块

### 1. 文档管理模块
- 历史方案上传与存储
- 文档分类管理（技术方案、商务方案、报价单等）
- 文档版本控制
- 文档搜索与检索

### 2. AI方案生成模块
- 客户需求分析
- 历史方案智能匹配
- 方案内容生成
- 方案优化建议

### 3. 知识库模块
- 产品知识库
- 解决方案库
- 案例库
- 行业知识库

### 4. 模板管理模块
- 方案模板管理
- 报价单模板
- 投标文档模板
- 自定义模板

### 5. 文档导出模块
- Word文档生成
- PDF导出
- Excel报价单生成
- 自定义格式支持

## 技术架构

### 后端技术栈
```
- 框架: FastAPI 0.104+
- 语言: Python 3.9+
- 数据库: PostgreSQL 14+
- 向量数据库: ChromaDB
- ORM: SQLAlchemy 2.0+
- AI框架: LangChain
- 文档处理:
  - python-docx (Word)
  - pypdf/pdfplumber (PDF)
  - openpyxl (Excel)
- 认证: JWT
```

### 前端技术栈
```
- 框架: React 18+
- 语言: TypeScript 5+
- UI组件: Ant Design 5+
- 状态管理: Redux Toolkit / Zustand
- HTTP客户端: Axios
- 富文本编辑器: Quill / TinyMCE
```

### AI能力
```
- LLM接口支持:
  - OpenAI API
  - 通义千问
  - 文心一言
  - 本地模型（Ollama）
- 向量化: sentence-transformers
- 语义搜索: ChromaDB/Faiss
```

## 系统架构图

```
┌─────────────────────────────────────────────────────────┐
│                      前端层 (React)                      │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │方案管理  │ │需求分析  │ │方案生成  │ │文档导出  │  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
└─────────────────────────────────────────────────────────┘
                            │
                         HTTPS
                            │
┌─────────────────────────────────────────────────────────┐
│                  API网关层 (FastAPI)                     │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │认证中间件│ │日志中间件│ │限流中间件│ │CORS处理  │  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
└─────────────────────────────────────────────────────────┘
                            │
                            │
┌─────────────────────────────────────────────────────────┐
│                     业务逻辑层                           │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │文档管理  │ │AI引擎    │ │模板引擎  │ │导出服务  │  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
└─────────────────────────────────────────────────────────┘
                            │
                            │
┌─────────────────────────────────────────────────────────┐
│                      数据层                              │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │
│  │PostgreSQL│ │ChromaDB  │ │文件存储  │ │Redis缓存 │  │
│  │(结构数据)│ │(向量数据)│ │(文档)    │ │          │  │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘  │
└─────────────────────────────────────────────────────────┘
```

## 数据模型设计

### 核心实体

1. **用户 (User)**
   - id, username, email, password_hash, role

2. **文档 (Document)**
   - id, title, type, file_path, upload_date, user_id
   - content_text, metadata (JSON)

3. **方案 (Proposal)**
   - id, title, customer_name, industry, requirements
   - generated_content, status, created_date

4. **模板 (Template)**
   - id, name, type, content, variables

5. **知识库条目 (KnowledgeBase)**
   - id, category, title, content, tags

## 开发阶段规划

### Phase 1: 基础设施搭建 (Week 1-2)
- [ ] 后端项目初始化
- [ ] 数据库设计与初始化
- [ ] 前端项目初始化
- [ ] 基础认证系统

### Phase 2: 文档管理 (Week 3-4)
- [ ] 文档上传功能
- [ ] 文档解析与存储
- [ ] 文档检索功能

### Phase 3: AI能力集成 (Week 5-6)
- [ ] LLM接口集成
- [ ] 向量化与语义搜索
- [ ] 方案生成引擎

### Phase 4: 前端界面 (Week 7-8)
- [ ] 主界面设计
- [ ] 方案生成界面
- [ ] 文档管理界面

### Phase 5: 文档导出 (Week 9)
- [ ] Word导出
- [ ] PDF导出
- [ ] Excel报价单

### Phase 6: 测试与优化 (Week 10)
- [ ] 功能测试
- [ ] 性能优化
- [ ] 用户体验优化

## 部署方案

### 开发环境
- Docker Compose 一键部署
- 前后端分离开发

### 生产环境
- Docker容器化部署
- Nginx反向代理
- PostgreSQL主从复制
- Redis缓存集群

## 安全性考虑

1. **认证授权**: JWT Token + 角色权限控制
2. **数据加密**: 敏感数据加密存储
3. **API安全**: 请求限流、参数校验
4. **文件安全**: 文件类型检查、病毒扫描
5. **日志审计**: 操作日志记录

## 可扩展性

1. **插件机制**: 支持自定义AI模型
2. **API开放**: RESTful API供第三方集成
3. **模板扩展**: 支持自定义模板
4. **多租户**: 支持多组织独立使用
